<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Ultimativer Shooter</title>
    <style>
        /* --- CSS Stildefinitionen --- */
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
        #gameCanvas {
            display: block;
            margin: 0 auto;
            background-color: #111;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>

    <script>
        /* --- Spiel Logik --- */

        // Canvas initialisieren
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Event Listener für Fenstergröße
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Spielerklasse
        class Player {
            constructor() {
                this.width = 50;
                this.height = 50;
                this.x = canvas.width / 2 - this.width / 2;
                this.y = canvas.height - this.height - 20;
                this.speed = 7;
                this.color = '#00ff99';
                this.bullets = [];
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }

            move() {
                if (keys['ArrowLeft'] && this.x > 0) {
                    this.x -= this.speed;
                }
                if (keys['ArrowRight'] && this.x + this.width < canvas.width) {
                    this.x += this.speed;
                }
                if (keys['ArrowUp'] && this.y > 0) {
                    this.y -= this.speed;
                }
                if (keys['ArrowDown'] && this.y + this.height < canvas.height) {
                    this.y += this.speed;
                }
            }

            shoot() {
                const bullet = new Bullet(this.x + this.width / 2, this.y);
                this.bullets.push(bullet);
            }
        }

        // Kugelklasse
        class Bullet {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.radius = 5;
                this.speed = 10;
                this.color = '#ffff00';
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.closePath();
            }

            update() {
                this.y -= this.speed;
            }
        }

        // Gegnerklasse
        class Enemy {
            constructor(x, y, speed) {
                this.width = 50;
                this.height = 50;
                this.x = x;
                this.y = y;
                this.speed = speed;
                this.color = '#ff3366';
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }

            update() {
                this.y += this.speed;
            }
        }

        // Spielvariablen
        const player = new Player();
        const enemies = [];
        const keys = {};
        let score = 0;
        let frames = 0;
        let enemyFrequency = 60; // Je kleiner, desto häufiger erscheinen Gegner

        // Tastatureingaben erfassen
        window.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            if (e.key === ' ') {
                player.shoot();
            }
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // Hauptspielschleife
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            frames++;

            // Spieleraktionen
            player.move();
            player.draw();

            // Kugeln aktualisieren
            player.bullets.forEach((bullet, bulletIndex) => {
                bullet.update();
                bullet.draw();

                // Entferne Kugeln außerhalb des Bildschirms
                if (bullet.y + bullet.radius < 0) {
                    player.bullets.splice(bulletIndex, 1);
                }
            });

            // Gegner erzeugen
            if (frames % enemyFrequency === 0) {
                const xPos = Math.random() * (canvas.width - 50);
                const speed = Math.random() * 3 + 2;
                const enemy = new Enemy(xPos, -50, speed);
                enemies.push(enemy);
            }

            // Gegner aktualisieren
            enemies.forEach((enemy, enemyIndex) => {
                enemy.update();
                enemy.draw();

                // Kollision mit Kugeln
                player.bullets.forEach((bullet, bulletIndex) => {
                    if (isColliding(bullet, enemy)) {
                        // Gegner und Kugel entfernen
                        setTimeout(() => {
                            enemies.splice(enemyIndex, 1);
                            player.bullets.splice(bulletIndex, 1);
                            score += 10;
                        }, 0);
                    }
                });

                // Kollision mit Spieler
                if (isColliding(player, enemy)) {
                    alert('Spiel vorbei! Dein Score: ' + score);
                    document.location.reload();
                }

                // Entferne Gegner außerhalb des Bildschirms
                if (enemy.y > canvas.height) {
                    enemies.splice(enemyIndex, 1);
                }
            });

            // Score anzeigen
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.fillText('Score: ' + score, 10, 30);

            requestAnimationFrame(gameLoop);
        }

        // Kollisionsprüfung
        function isColliding(a, b) {
            return (
                a.x < b.x + b.width &&
                a.x + (a.width || a.radius * 2) > b.x &&
                a.y < b.y + b.height &&
                a.y + (a.height || a.radius * 2) > b.y
            );
        }

        // Spiel starten
        gameLoop();
    </script>
</body>
</html>
