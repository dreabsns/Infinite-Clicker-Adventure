<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Pseudo-3D Shooter</title>
    <style>
        /* --- CSS Stildefinitionen --- */
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
        #gameCanvas {
            display: block;
            margin: 0 auto;
            background-color: #1a1a1a;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>

    <script>
        /* --- Pseudo-3D Shooter Spiel --- */

        // Canvas initialisieren
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Event Listener für Fenstergröße
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Spielvariablen
        const keys = {};
        let player, obstacles, bullets, score, speed;

        // Spielerklasse
        class Player {
            constructor() {
                this.width = 50;
                this.height = 75;
                this.x = canvas.width / 2 - this.width / 2;
                this.y = canvas.height - this.height - 30;
                this.color = '#00ff99';
                this.speed = 7;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.moveTo(this.x + this.width / 2, this.y);
                ctx.lineTo(this.x + this.width, this.y + this.height);
                ctx.lineTo(this.x, this.y + this.height);
                ctx.closePath();
                ctx.fill();
            }

            move() {
                if (keys['ArrowLeft'] && this.x > 0) {
                    this.x -= this.speed;
                }
                if (keys['ArrowRight'] && this.x + this.width < canvas.width) {
                    this.x += this.speed;
                }
            }
        }

        // Hindernis (Gegner) Klasse
        class Obstacle {
            constructor(x, width, speed) {
                this.x = x;
                this.y = -50;
                this.width = width;
                this.height = 50;
                this.speed = speed;
                this.color = '#ff3366';
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }

            update() {
                this.y += this.speed;
            }
        }

        // Kugelklasse
        class Bullet {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.radius = 5;
                this.speed = 10;
                this.color = '#ffff00';
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.closePath();
            }

            update() {
                this.y -= this.speed;
            }
        }

        // Tastatureingaben erfassen
        window.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            if (e.key === ' ') {
                shoot();
            }
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // Schießen
        function shoot() {
            const bullet = new Bullet(player.x + player.width / 2, player.y);
            bullets.push(bullet);
        }

        // Initialisierung
        function init() {
            player = new Player();
            obstacles = [];
            bullets = [];
            score = 0;
            speed = 5;
        }

        // Hauptspielschleife
        let frame = 0;
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            frame++;

            // Spieleraktionen
            player.move();
            player.draw();

            // Kugeln aktualisieren
            bullets.forEach((bullet, bulletIndex) => {
                bullet.update();
                bullet.draw();

                // Entferne Kugeln außerhalb des Bildschirms
                if (bullet.y + bullet.radius < 0) {
                    bullets.splice(bulletIndex, 1);
                }
            });

            // Hindernisse erzeugen
            if (frame % 20 === 0) {
                const obstacleWidth = Math.random() * 100 + 50;
                const xPos = Math.random() * (canvas.width - obstacleWidth);
                const obstacle = new Obstacle(xPos, obstacleWidth, speed);
                obstacles.push(obstacle);
            }

            // Hindernisse aktualisieren
            obstacles.forEach((obstacle, obstacleIndex) => {
                obstacle.update();
                obstacle.draw();

                // Kollision mit Kugeln
                bullets.forEach((bullet, bulletIndex) => {
                    if (isColliding(bullet, obstacle)) {
                        bullets.splice(bulletIndex, 1);
                        obstacles.splice(obstacleIndex, 1);
                        score += 10;
                    }
                });

                // Kollision mit Spieler
                if (isColliding(player, obstacle)) {
                    alert('Spiel vorbei! Dein Score: ' + score);
                    document.location.reload();
                }

                // Entferne Hindernisse außerhalb des Bildschirms
                if (obstacle.y > canvas.height) {
                    obstacles.splice(obstacleIndex, 1);
                }
            });

            // Boden zeichnen (Pseudo-3D-Effekt)
            drawGround();

            // Score anzeigen
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.fillText('Score: ' + score, 10, 30);

            requestAnimationFrame(gameLoop);
        }

        // Boden zeichnen für Pseudo-3D-Effekt
        function drawGround() {
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.moveTo(0, canvas.height);
            ctx.lineTo(canvas.width / 2 - 100, canvas.height / 2);
            ctx.lineTo(canvas.width / 2 + 100, canvas.height / 2);
            ctx.lineTo(canvas.width, canvas.height);
            ctx.closePath();
            ctx.fill();
        }

        // Kollisionsprüfung
        function isColliding(a, b) {
            return (
                a.x < b.x + b.width &&
                a.x + (a.width || a.radius * 2) > b.x &&
                a.y < b.y + b.height &&
                a.y + (a.height || a.radius * 2) > b.y
            );
        }

        // Spiel starten
        init();
        gameLoop();
    </script>
</body>
</html>
